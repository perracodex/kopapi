## Defining the Request Body

Specify the structure and type of the request body.

- Only one request body can be defined per route.

```kotlin
requestBody<MyRequestBodyType> {
    description = "The data required to create a new item."
}
```

- **Properties:**
    - `description`: A description of the request body's content and what it represents.
  - `required`: Indicates whether the request body is mandatory for the API call. (Default: `true`)
  - `composition`: The composition strategy when multiple types are registered. (Default: `Composition.ANY_OF`

---

### Additional Types and Content-Types

Besides the primary request body type, you can also register additional types, including multiple `ContentTypes`.

```kotlin
requestBody<MyRequestBodyType>(
  contentType = setOf(
    ContentType.Application.Json,
    ContentType.Application.Xml
  )
) {
    // Register an additional type.
  addType<AdditionalType>()

    // Register another type to the PDF ContentType
    // instead of the default.
  addType<YetAnotherTpe>(contentType = ContentType.Application.Pdf)
}
```

This will result in the following OpenAPI definition:

```yaml
requestBody:
  required: true
  content:
    application/json:
      schema:
        anyOf:
          - $ref: "#/components/schemas/MyRequestBodyType"
          - $ref: "#/components/schemas/AdditionalType"
    application/xml:
      schema:
        anyOf:
          - $ref: "#/components/schemas/MyRequestBodyType"
          - $ref: "#/components/schemas/AdditionalType"
    application/pdf:
      schema:
        $ref: "#/components/schemas/YetAnotherTpe"
```

---

### Multipart Form Data

To define a request body as `multipart` use the `multipart` function.

- **`contentType`**: Specify the `ContentType.MultiPart` by passing it as a parameter. Default: `ContentType.MultiPart.FormData`.
- Use Ktor's `PartData` subclasses to specify the part type.

```kotlin
multipart {
  part<PartData.FileItem>("myFilePart") {
    description = "The file to upload."
  }
}
```

Or specify the content details explicitly:

```kotlin
multipart(contentType = ContentType.MultiPart.Encrypted) {
  part<PartData.FormItem>("myFormPart") {
    description = "The form data."
  }
}
```

- **Properties of Part:**
  - `description`: A description of the part's content and what it represents.
  - `required`: Indicates whether the part is mandatory for the API call. (Default: `true`)
  - `schemaType`: Specify the type for the schema, such as STRING, NUMBER, etc. (Optional).
  - `schemaFormat`: Specify the format for the schema, such as BINARY, UUID, etc. (Optional).
  - `contentType`: Optional parameter to explicitly define the content type of the part. By default inferred on the type of `PartData`.

---

### Example

```kotlin
// Upload employee profile details, including image, resume, and metadata.
multipart(contentType = ContentType.MultiPart.Mixed) {

  // Upload the employee's profile picture as an image (PNG)
  part<PartData.FileItem>("profilePicture", contentType = ContentType.Image.PNG) {
    description = "The employee's profile picture."
    schemaType = ApiType.STRING
    schemaFormat = ApiFormat.BINARY
  }

  // Upload the employee's resume as a PDF file
  part<PartData.FileItem>("resume", contentType = ContentType.Application.Pdf) {
    description = "The employee's resume in PDF format."
    schemaType = ApiType.STRING
    schemaFormat = ApiFormat.BINARY
  }

  // Add a form field for the employee's name (plain text)
  part<PartData.FormItem>("employeeName") {
    description = "The employee's full name."
    schemaType = ApiType.STRING
  }

  // Add a form field for the employee's unique ID (UUID)
  part<PartData.FormItem>("employeeId", contentType = ContentType.Application.Json) {
    description = "The employee's unique identifier (UUID)."
    schemaType = ApiType.STRING
    schemaFormat = ApiFormat.UUID
  }

  // Upload additional metadata as JSON (custom object)
  part<PartData.FormItem>("metadata", contentType = ContentType.Application.Json) {
    description = "Additional metadata about the employee."
    schemaType = ApiType.OBJECT
  }

  // Allow uploading additional notes in XML format
  part<PartData.FormItem>("notes", contentType = ContentType.Application.Xml) {
    description = "Additional notes about the employee."
    schemaType = ApiType.STRING
    schemaFormat = ApiFormat.URI
  }
}
```

Resulting Output:

```yaml
requestBody:
  required: true
  content:
    multipart/mixed:
      schema:
        type: object
        properties:
          profilePicture:
            description: "The employee's profile picture."
            content:
              image/png:
                schema:
                  type: "string"
                  format: "binary"
          resume:
            description: "The employee's resume in PDF format."
            content:
              application/pdf:
                schema:
                  type: "string"
                  format: "binary"
          employeeName:
            description: "The employee's full name."
            content:
              text/plain:
                schema:
                  type: "string"
          employeeId:
            description: "The employee's unique identifier (UUID)."
            content:
              application/json:
                schema:
                  type: "string"
                  format: "uuid"
          metadata:
            description: "Additional metadata about the employee."
            content:
              application/json:
                schema:
                  type: "object"
          notes:
            description: "Additional notes about the employee."
            content:
              application/xml:
                schema:
                  type: "string"
                  format: "uri"
        required:
          - profilePicture
          - resume
          - employeeName
          - employeeId
          - metadata
          - notes
```

---

### [Responses ðŸ¡²](02.5.api-usage-responses.md)

#### [ðŸ¡° Parameters](02.3.api-usage-parameters.md)
