## Defining Responses

Define the possible responses to an API Operation using the `response` function.

```kotlin
api {
  // Response with a body type.
  response<MyResponseType>(status = HttpStatusCode.OK) { }

  // Response without a body type.
  response(status = HttpStatusCode.OK) { }
}
```

### Multiple Content Types

Can add multiple content types to a response, if omitted, the default content type is `application/json`.

```kotlin
api {
    response<MyResponseType>(status = HttpStatusCode.OK) {
      contentType = setOf(
        ContentType.Application.Json,
        ContentType.Application.Xml
      )
    }
}
```

---

### Additional Types

```kotlin
api {
  response<MyResponseType>(status = HttpStatusCode.OK) {
    composition = Composition.AnyOf // If omitted, defaults to `AnyOf`.
    type<AnotherType>()
    type<YetAnotherType>()
  }
}
```

- When a main response body type is specified, it will be combined with any additional types using the specified composition.
- If no composition is specified, it defaults to `AnyOf`.

---

### Headers and Links to Responses

```kotlin
api {
    response<MyResponseType>(status = HttpStatusCode.OK) {
        header(name = "X-Rate-Limit") {
            description = "The number of allowed requests in the current period."
            required = true
        }
        link(operationId = "getNextItem") {
            description = "Link to the next item."
        }
    }
}
```

- **Headers properties:**
  - `name`: The name of the header.
  - `description`: A human-readable description of the header.
  - `required`: Indicates whether the header is mandatory.
  - `deprecated`: Indicates whether the header is deprecated and should be avoided.


- **Link properties:**
  - `operationId`: The name of an existing, resolvable OAS operation.
  - `description`: A human-readable description of the link.

---

### Multiple Responses in an API Operation

It is also possible to define multiple responses for an API Operation.
In such case these will be combined by their status code.

Each response can define its own content types, headers, links, and additional types.
These will be merged and grouped according to their `status code` and `Content-Type`.

```kotlin
api {
  response<MyResponseType>(status = HttpStatusCode.OK) { desription = "Example 1." }

  response<AnotherResponseType>(status = HttpStatusCode.OK) {
    description = "Example 2."
    contentType = setOf(ContentType.Application.Json, ContentType.Application.Xml)
  }

  response(status = HttpStatusCode.NotFound) { description = "Not Found." }
}
```

- The above example will result in two grouped responses:
  - One for `200 OK` with a body of `MyResponseType` and `DifferentResponseType`.
  - Another for `404 Not Found`

```yaml
responses:
  "200":
    description: |-
      Example 1.
      Example 2.
    content:
      application/json:
        schema:
          anyOf:
            - $ref: "#/components/schemas/MyResponseType"
            - $ref: "#/components/schemas/AnotherResponseType"
      application/xml:
        schema:
          - $ref: "#/components/schemas/AnotherResponseType"
  "404":
    description: "Not found."
```

---

### Composition

The `composition` property can be used to specify how multiple types within a concrete `Status Code` should be combined.

- If no types or a single type is specified, the composition is ignored.
- If no composition is specified, it defaults to `AnyOf`.

```kotlin
api {
  response<MyResponseType>(status = HttpStatusCode.OK) {
    composition = Composition.OneOf
    type<AnotherType>()
    type<YetAnotherType>()
  }
}
```

This will result in a response body that is a `OneOf` type of `MyResponseType`, `AnotherType`, and `YetAnotherType`.

```yaml
content:
  application/json:
    schema:
      oneOf:
        - $ref: "#/components/schemas/MyResponseType"
        - $ref: "#/components/schemas/AnotherType"
        - $ref: "#/components/schemas/YetAnotherType"
```

--- 

### Full Example

```kotlin
api {
  response<MyResponseType>(status = HttpStatusCode.OK) {
    // Optional description.
    description = "Successfully retrieved the item."

    // Optional content types. If not specified, defaults to JSON.
    contentType = setOf(
      ContentType.Application.Json,
      ContentType.Application.Xml
    )

    // Optional Headers and Links.
    header(name = "X-Rate-Limit") {
      description = "The number of allowed requests in the current period."
      required = true
    }
    link(operationId = "getNextItem") {
      description = "Link to the next item."
    }

    // Optional additional types and composition.
    composition = Composition.AnyOf // If omitted, defaults to `AnyOf`.
    type<AnotherType>()
    type<YetAnotherType>()
  }
}
```

### [Endpoints Security ðŸ¡²](02.6.api-usage-security.md)

#### [ðŸ¡° Request Body](02.4.api-usage-request-body.md)
